/*
 *  jsaes version 0.1  -  Copyright 2006 B. Poettering
 *
 *  This program is free software; you can redistribute it and/or
 *  modify it under the terms of the GNU General Public License as
 *  published by the Free Software Foundation; either version 2 of the
 *  License, or (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 *  General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program; if not, write to the Free Software
 *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
 *  02111-1307 USA
 */// later modifications by wwwtyro@github
var aes=function(){var e={};e.Sbox=new Array(99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22);e.ShiftRowTab=new Array(0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11);e.Init=function(){e.Sbox_Inv=new Array(256);for(var t=0;t<256;t++)e.Sbox_Inv[e.Sbox[t]]=t;e.ShiftRowTab_Inv=new Array(16);for(var t=0;t<16;t++)e.ShiftRowTab_Inv[e.ShiftRowTab[t]]=t;e.xtime=new Array(256);for(var t=0;t<128;t++){e.xtime[t]=t<<1;e.xtime[128+t]=t<<1^27}};e.Done=function(){delete e.Sbox_Inv;delete e.ShiftRowTab_Inv;delete e.xtime};e.ExpandKey=function(t){var n=t.length,r,i=1;switch(n){case 16:r=176;break;case 24:r=208;break;case 32:r=240;break;default:alert("my.ExpandKey: Only key lengths of 16, 24 or 32 bytes allowed!")}for(var s=n;s<r;s+=4){var o=t.slice(s-4,s);if(s%n==0){o=new Array(e.Sbox[o[1]]^i,e.Sbox[o[2]],e.Sbox[o[3]],e.Sbox[o[0]]);(i<<=1)>=256&&(i^=283)}else n>24&&s%n==16&&(o=new Array(e.Sbox[o[0]],e.Sbox[o[1]],e.Sbox[o[2]],e.Sbox[o[3]]));for(var u=0;u<4;u++)t[s+u]=t[s+u-n]^o[u]}};e.Encrypt=function(t,n){var r=n.length;e.AddRoundKey(t,n.slice(0,16));for(var i=16;i<r-16;i+=16){e.SubBytes(t,e.Sbox);e.ShiftRows(t,e.ShiftRowTab);e.MixColumns(t);e.AddRoundKey(t,n.slice(i,i+16))}e.SubBytes(t,e.Sbox);e.ShiftRows(t,e.ShiftRowTab);e.AddRoundKey(t,n.slice(i,r))};e.Decrypt=function(t,n){var r=n.length;e.AddRoundKey(t,n.slice(r-16,r));e.ShiftRows(t,e.ShiftRowTab_Inv);e.SubBytes(t,e.Sbox_Inv);for(var i=r-32;i>=16;i-=16){e.AddRoundKey(t,n.slice(i,i+16));e.MixColumns_Inv(t);e.ShiftRows(t,e.ShiftRowTab_Inv);e.SubBytes(t,e.Sbox_Inv)}e.AddRoundKey(t,n.slice(0,16))};e.SubBytes=function(e,t){for(var n=0;n<16;n++)e[n]=t[e[n]]};e.AddRoundKey=function(e,t){for(var n=0;n<16;n++)e[n]^=t[n]};e.ShiftRows=function(e,t){var n=(new Array).concat(e);for(var r=0;r<16;r++)e[r]=n[t[r]]};e.MixColumns=function(t){for(var n=0;n<16;n+=4){var r=t[n+0],i=t[n+1],s=t[n+2],o=t[n+3],u=r^i^s^o;t[n+0]^=u^e.xtime[r^i];t[n+1]^=u^e.xtime[i^s];t[n+2]^=u^e.xtime[s^o];t[n+3]^=u^e.xtime[o^r]}};e.MixColumns_Inv=function(t){for(var n=0;n<16;n+=4){var r=t[n+0],i=t[n+1],s=t[n+2],o=t[n+3],u=r^i^s^o,a=e.xtime[u],f=e.xtime[e.xtime[a^r^s]]^u,l=e.xtime[e.xtime[a^i^o]]^u;t[n+0]^=f^e.xtime[r^i];t[n+1]^=l^e.xtime[i^s];t[n+2]^=f^e.xtime[s^o];t[n+3]^=l^e.xtime[o^r]}};return e}();